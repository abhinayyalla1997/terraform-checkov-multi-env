{"check_type": "terraform", "results": {"passed_checks": [], "failed_checks": [{"check_id": "CKV_AWS_88", "bc_check_id": "BC_AWS_PUBLIC_12", "check_name": "EC2 instance should not have public IP.", "check_result": {"result": "FAILED", "evaluated_keys": ["associate_public_ip_address"]}, "code_block": [[29, "resource \"aws_instance\" \"this\" {\n"], [30, "  for_each = var.instances\n"], [31, "\n"], [32, "  ami                    = data.aws_ami.selected.id\n"], [33, "  instance_type          = each.value.instance_type\n"], [34, "  subnet_id              = var.subnet_id\n"], [35, "  key_name               = var.key_name\n"], [36, "  associate_public_ip_address = true\n"], [37, "  vpc_security_group_ids = [each.value.sg_id]\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.environment}-${each.key}\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "/../../modules/ec2/main.tf", "file_abs_path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/modules/ec2/main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [29, 44], "resource": "module.ec2.aws_instance.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.EC2PublicIP", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.environment}-${each.key}", "Project": "var.project"}, "caller_file_path": "/main.tf", "caller_file_line_range": [63, 82], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/public-policies/public-12", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/modules/ec2/main.tf", "breadcrumbs": {"source_module_": [{"type": "module", "name": "ec2", "path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/env/Prod/main.tf", "idx": 11, "source_module_object": null}]}}, {"check_id": "CKV_AWS_79", "bc_check_id": "BC_AWS_GENERAL_31", "check_name": "Ensure Instance Metadata Service Version 1 is not enabled", "check_result": {"result": "FAILED", "evaluated_keys": ["metadata_options/[0]/http_tokens"]}, "code_block": [[29, "resource \"aws_instance\" \"this\" {\n"], [30, "  for_each = var.instances\n"], [31, "\n"], [32, "  ami                    = data.aws_ami.selected.id\n"], [33, "  instance_type          = each.value.instance_type\n"], [34, "  subnet_id              = var.subnet_id\n"], [35, "  key_name               = var.key_name\n"], [36, "  associate_public_ip_address = true\n"], [37, "  vpc_security_group_ids = [each.value.sg_id]\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.environment}-${each.key}\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "/../../modules/ec2/main.tf", "file_abs_path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/modules/ec2/main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [29, 44], "resource": "module.ec2.aws_instance.this", "evaluations": null, "check_class": "checkov.terraform.checks.resource.aws.IMDSv1Disabled", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.environment}-${each.key}", "Project": "var.project"}, "caller_file_path": "/main.tf", "caller_file_line_range": [63, 82], "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-general-policies/bc-aws-general-31", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/modules/ec2/main.tf", "breadcrumbs": {"source_module_": [{"type": "module", "name": "ec2", "path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/env/Prod/main.tf", "idx": 11, "source_module_object": null}]}}, {"check_id": "CKV2_AWS_11", "bc_check_id": "BC_AWS_LOGGING_9", "check_name": "Ensure VPC flow logging is enabled in all VPCs", "check_result": {"result": "FAILED", "entity": {"aws_vpc": {"this": {"__end_line__": 16, "__start_line__": 2, "cidr_block": ["var.vpc_cidr"], "enable_dns_hostnames": [true], "enable_dns_support": [true], "instance_tenancy": ["default"], "tags": ["${merge({'Name': '${var.environment}-${var.vpc_name}', 'Environment': '${var.environment}', 'Project': '${var.project}'},var.tags)}"], "__address__": "module.vpc.aws_vpc.this", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["resource_type", "networking"]}, "code_block": [[2, "resource \"aws_vpc\" \"this\" {\n"], [3, "  cidr_block           = var.vpc_cidr\n"], [4, "  enable_dns_hostnames = var.enable_dns_hostnames\n"], [5, "  enable_dns_support   = var.enable_dns_support\n"], [6, "  instance_tenancy     = var.instance_tenancy\n"], [7, "\n"], [8, "  tags = merge(\n"], [9, "    {\n"], [10, "      Name        = \"${var.environment}-${var.vpc_name}\"\n"], [11, "      Environment = var.environment\n"], [12, "      Project     = var.project\n"], [13, "    },\n"], [14, "    var.tags\n"], [15, "  )\n"], [16, "}\n"]], "file_path": "/../../modules/vpc/main.tf", "file_abs_path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/modules/vpc/main.tf", "repo_file_path": "/modules/vpc/main.tf", "file_line_range": [2, 16], "resource": "module.vpc.aws_vpc.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": null, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-logging-policies/logging-9-enable-vpc-flow-logging", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/modules/vpc/main.tf", "breadcrumbs": {"enable_dns_hostnames": [{"type": "variable", "name": "enable_dns_hostnames", "path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/modules/vpc/variables.tf", "module_connection": false}], "enable_dns_support": [{"type": "variable", "name": "enable_dns_support", "path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/modules/vpc/variables.tf", "module_connection": false}], "instance_tenancy": [{"type": "variable", "name": "instance_tenancy", "path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/modules/vpc/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "vpc", "path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/env/Prod/main.tf", "idx": 9, "source_module_object": null}]}}, {"check_id": "CKV_AWS_18", "bc_check_id": "BC_AWS_S3_13", "check_name": "Ensure the S3 bucket has access logging enabled", "check_result": {"result": "FAILED", "entity": {"aws_s3_bucket": {"this": {"__end_line__": 9, "__start_line__": 1, "bucket": ["prod-checkov-s3"], "tags": [{"Environment": "prod", "Name": "prod-checkov-s3", "Project": "checkov"}], "__address__": "module.s3.aws_s3_bucket.this", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["resource_type", "logging"]}, "code_block": [[1, "resource \"aws_s3_bucket\" \"this\" {\n"], [2, "  bucket = \"${var.environment}-${var.project}-s3\"\n"], [3, "\n"], [4, "  tags = {\n"], [5, "    Name        = \"${var.environment}-${var.project}-s3\"\n"], [6, "    Environment = var.environment\n"], [7, "    Project     = var.project\n"], [8, "  }\n"], [9, "}\n"]], "file_path": "/../../modules/s3/main.tf", "file_abs_path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/modules/s3/main.tf", "repo_file_path": "/modules/s3/main.tf", "file_line_range": [1, 9], "resource": "module.s3.aws_s3_bucket.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "prod", "Name": "prod-checkov-s3", "Project": "checkov"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/s3-policies/s3-13-enable-logging", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/modules/s3/main.tf", "breadcrumbs": {"tags.Environment": [{"type": "module", "name": "s3", "path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/env/Prod/main.tf", "module_connection": false}, {"type": "variable", "name": "environment", "path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/modules/s3/variables.tf", "module_connection": false}], "bucket": [{"type": "module", "name": "s3", "path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/env/Prod/main.tf", "module_connection": false}, {"type": "variable", "name": "project", "path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/modules/s3/variables.tf", "module_connection": false}], "tags.Name": [{"type": "module", "name": "s3", "path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/env/Prod/main.tf", "module_connection": false}, {"type": "variable", "name": "environment", "path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/modules/s3/variables.tf", "module_connection": false}], "tags.Project": [{"type": "module", "name": "s3", "path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/env/Prod/main.tf", "module_connection": false}, {"type": "variable", "name": "project", "path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/modules/s3/variables.tf", "module_connection": false}], "source_module_": [{"type": "module", "name": "s3", "path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/env/Prod/main.tf", "idx": 12, "source_module_object": null}]}}, {"check_id": "CKV2_AWS_41", "bc_check_id": "BC_AWS_IAM_69", "check_name": "Ensure an IAM role is attached to EC2 instance", "check_result": {"result": "FAILED", "entity": {"aws_instance": {"this": {"__end_line__": 44, "__start_line__": 29, "ami": ["data.aws_ami.selected.id"], "associate_public_ip_address": [true], "for_each": ["var.instances"], "instance_type": ["each.value.instance_type"], "key_name": ["var.key_name"], "subnet_id": ["var.subnet_id"], "tags": [{"Environment": "var.environment", "Name": "${var.environment}-${each.key}", "Project": "var.project"}], "vpc_security_group_ids": [["each.value.sg_id"]], "__address__": "module.ec2.aws_instance.this", "__provider_address__": "aws.default"}}}, "evaluated_keys": ["iam_instance_profile"]}, "code_block": [[29, "resource \"aws_instance\" \"this\" {\n"], [30, "  for_each = var.instances\n"], [31, "\n"], [32, "  ami                    = data.aws_ami.selected.id\n"], [33, "  instance_type          = each.value.instance_type\n"], [34, "  subnet_id              = var.subnet_id\n"], [35, "  key_name               = var.key_name\n"], [36, "  associate_public_ip_address = true\n"], [37, "  vpc_security_group_ids = [each.value.sg_id]\n"], [38, "\n"], [39, "  tags = {\n"], [40, "    Name        = \"${var.environment}-${each.key}\"\n"], [41, "    Environment = var.environment\n"], [42, "    Project     = var.project\n"], [43, "  }\n"], [44, "}\n"]], "file_path": "/../../modules/ec2/main.tf", "file_abs_path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/modules/ec2/main.tf", "repo_file_path": "/modules/ec2/main.tf", "file_line_range": [29, 44], "resource": "module.ec2.aws_instance.this", "evaluations": null, "check_class": "checkov.common.graph.checks_infra.base_check", "fixed_definition": null, "entity_tags": {"Environment": "var.environment", "Name": "${var.environment}-${each.key}", "Project": "var.project"}, "caller_file_path": null, "caller_file_line_range": null, "resource_address": null, "severity": null, "bc_category": null, "benchmarks": null, "description": null, "short_description": null, "vulnerability_details": null, "connected_node": null, "guideline": "https://docs.prismacloud.io/en/enterprise-edition/policy-reference/aws-policies/aws-iam-policies/ensure-an-iam-role-is-attached-to-ec2-instance", "details": [], "check_len": null, "definition_context_file_path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/modules/ec2/main.tf", "breadcrumbs": {"source_module_": [{"type": "module", "name": "ec2", "path": "/home/runner/work/terraform-checkov-multi-env/terraform-checkov-multi-env/env/Prod/main.tf", "idx": 11, "source_module_object": null}]}}], "skipped_checks": [], "parsing_errors": []}, "summary": {"passed": 0, "failed": 5, "skipped": 0, "parsing_errors": 0, "resource_count": 21, "checkov_version": "3.2.497"}, "url": "Add an api key '--bc-api-key <api-key>' to see more detailed insights via https://bridgecrew.cloud"}